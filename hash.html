<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hashing und Rainbow Tables Lab</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        h1, h2 {
            text-align: center;
            color: #007bff;
        }
        .info {
            background: #f4f4f4;
            padding: 15px;
            border-left: 4px solid #007bff;
            margin-bottom: 20px;
        }
        .steps {
            margin-top: 20px;
        }
        .steps p {
            margin: 10px 0;
        }
        .btn {
            display: inline-block;
            padding: 10px 15px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin-top: 10px;
            text-align: center;
        }
        .btn:hover {
            background: #0056b3;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hashing und Rainbow Tables Lab</h1>

        <!-- Ausführlicher Info-Text -->
        <div class="info">
            <h2>Was sind Hashes und warum sind sie wichtig?</h2>
            <p>Ein Hash ist das Ergebnis einer mathematischen Funktion, die Daten – wie Passwörter – in eine fixe Zeichenkette umwandelt. 
            Hashes werden oft verwendet, um Passwörter sicher in Datenbanken zu speichern. Ein Vorteil von Hashes ist, dass sie irreversibel sind: 
            Das bedeutet, dass man den ursprünglichen Wert nicht direkt aus dem Hash errechnen kann. So bleibt dein Passwort geschützt, selbst wenn 
            die Datenbank kompromittiert wird.</p>

            <h2>Was sind Rainbow Tables?</h2>
            <p>Rainbow Tables sind vorberechnete Tabellen, die zu bestimmten Hashes die dazugehörigen ursprünglichen Passwörter speichern. 
            Damit können Angreifer bekannte Hashes sehr schnell entschlüsseln, ohne den gesamten Rechenaufwand eines Brute-Force-Angriffs 
            auf sich nehmen zu müssen. Das macht Rainbow Tables zu einem leistungsstarken Werkzeug für Angriffe auf schwache Passwörter.</p>

            <h2>Wie schützt Salt vor Rainbow Tables?</h2>
            <p>Ein Salt ist eine zufällige Zeichenkette, die vor dem Hashing zu einem Passwort hinzugefügt wird. Dadurch wird der Hash für jedes 
            Passwort einzigartig, selbst wenn mehrere Nutzer dasselbe Passwort verwenden. Rainbow Tables werden dadurch nutzlos, da sie auf 
            den zusätzlichen Salt nicht vorbereitet sind. Ohne den genauen Salt können Angreifer den Hash nicht entschlüsseln.</p>
        </div>

        <!-- Aufgabe -->
        <div class="steps">
            <h2>Aufgabe</h2>
            <h3>Schritt 1: Nutze CrackStation</h3>
            <p>
                Öffne <a href="https://crackstation.net/" target="_blank">CrackStation</a>. Kopiere die folgenden Hashes und füge sie 
                in das Eingabefeld bei CrackStation ein:
            </p>
            <pre>
1. 5f4dcc3b5aa765d61d8327deb882cf99
2. 098f6bcd4621d373cade4e832627b4f6
            </pre>
            <p>Finde heraus, welche Passwörter zu diesen Hashes gehören.</p>

            <h3>Schritt 2: Flag finden</h3>
            <p>
                Nachdem du die Passwörter entschlüsselt hast, gib eines davon hier ein, um die Flag zu erhalten:
            </p>
            <input type="text" id="flag1" placeholder="Flag eingeben">
            <button class="btn" onclick="checkFlag('password', '{PANZERKNACKER}')">Prüfen</button>
        </div>

        <!-- Bonus-Aufgabe -->
        <div class="steps hidden" id="bonus-task">
            <h2>Bonus: Mit Salt arbeiten</h2>
            <h3>Was ist ein Salt?</h3>
            <p>Ein Salt ist eine zufällige Zeichenkette, die vor dem Hashing an das Passwort angehängt wird. Dadurch wird jeder Hash einzigartig 
            – selbst wenn mehrere Personen dasselbe Passwort verwenden. Das schützt vor Rainbow-Table-Angriffen.</p>

            <h3>Wie funktioniert Salt in der Praxis?</h3>
            <p>Du kannst Salt manuell simulieren, indem du den Salt zum Passwort hinzufügst. Für unser Beispiel sieht das so aus:</p>
            <pre>
Passwort: password123
Salt: 2023
Zu hashen: password1232023
            </pre>
            <p>Gib die Kombination aus Passwort und Salt in CrackStation ein, um den Hash zu generieren. Der korrekte Hash ist:</p>
            <pre>
098f6bcd4621d373cade4e832627b4f62023
            </pre>
            <p>
                Nutze diesen Hash, um die Bonus-Flag zu erhalten. Gib sie hier ein:
            </p>
            <input type="text" id="flag2" placeholder="Bonus-Flag eingeben">
            <button class="btn" onclick="checkBonusFlag('098f6bcd4621d373cade4e832627b4f62023', '{ADD_A_PINCH_OF_SALT}')">Prüfen</button>
        </div>
    </div>

    <script>
        function checkFlag(password, flag) {
            const input = document.getElementById('flag1').value.trim();
            if (input === password) {
                alert(`Richtig! Hier ist deine Flag: ${flag}`);
                document.getElementById('bonus-task').classList.remove('hidden');
            } else {
                alert("Falsch! Versuche es erneut.");
            }
        }

        function checkBonusFlag(hash, flag) {
            const input = document.getElementById('flag2').value.trim();
            if (input === hash) {
                alert(`Richtig! Hier ist deine Bonus-Flag: ${flag}`);
            } else {
                alert("Falsch! Überprüfe deine Berechnungen.");
            }
        }
    </script>
</body>
</html>


