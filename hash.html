<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hashing und Rainbow Tables Lab</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        h1, h2 {
            text-align: center;
            color: #007bff;
        }
        .info {
            background: #f4f4f4;
            padding: 15px;
            border-left: 4px solid #007bff;
            margin-bottom: 20px;
        }
        .steps {
            margin-top: 20px;
        }
        .steps p {
            margin: 10px 0;
        }
        .console {
            background: #000;
            color: #0f0;
            font-family: monospace;
            padding: 15px;
            border-radius: 5px;
            height: 200px;
            overflow-y: auto;
            margin-bottom: 20px;
        }
        .btn {
            display: inline-block;
            padding: 10px 15px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin-top: 10px;
            text-align: center;
        }
        .btn:hover {
            background: #0056b3;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hashing und Rainbow Tables Lab</h1>

        <div class="info">
            <h2>Was sind Hashes und Rainbow Tables?</h2>
            <p>
                Hashes sind mathematische Funktionen, die Eingabedaten wie Passwörter in scheinbar zufällige, 
                fixe Ausgabewerte umwandeln. Ein Hash ist irreversibel, d.h., die ursprüngliche Eingabe kann nicht 
                direkt aus dem Hash zurückgerechnet werden. Beispiele für Hash-Funktionen sind MD5, SHA-1 oder SHA-256.
            </p>
            <p>
                Hashing wird häufig in der IT-Sicherheit genutzt, um Passwörter zu schützen. Wenn ein Nutzer 
                sein Passwort eingibt, wird es gehasht und mit dem gespeicherten Hash verglichen. So wird verhindert, 
                dass Klartext-Passwörter in Datenbanken gespeichert werden.
            </p>
            <p>
                Rainbow Tables sind vorberechnete Tabellen von Hash-Werten und deren Ursprungswerten. 
                Sie machen es Angreifern leichter, gehashte Passwörter zu knacken, indem sie schnell 
                nach einem passenden Hash suchen können. Um Rainbow Tables unwirksam zu machen, 
                wird oft ein sogenanntes "Salt" hinzugefügt.
            </p>
        </div>

        <div class="steps">
            <h2>Aufgabe</h2>
            <p>In dieser Aufgabe sind zwei gehashte Passwörter vorgegeben. Deine Aufgabe ist es, mit CyberChef die ursprünglichen Passwörter zu finden und die Flag zu erhalten:</p>

            <h3>Schritt 1: Nutze CyberChef</h3>
            <p>
                Öffne <a href="https://gchq.github.io/CyberChef/" target="_blank">CyberChef</a>. Kopiere die folgenden Hashes in das Eingabefeld:
            </p>
            <pre>
                1. 5f4dcc3b5aa765d61d8327deb882cf99
                2. 098f6bcd4621d373cade4e832627b4f6
            </pre>
            <p>Verwende CyberChef mit der "From Hex"-Funktion, um herauszufinden, ob diese Hashes bekannten Passwörtern entsprechen. Was findest du?</p>

            <h3>Schritt 2: Finde die Flag</h3>
            <p>Wenn du die ursprünglichen Passwörter gefunden hast, gib eines der beiden als Flag ein:</p>
            <input type="text" id="flag1" placeholder="Flag eingeben">
            <button class="btn" onclick="checkFlag('password', '{LET_HIM_COOK}')">Prüfen</button>
        </div>

        <div class="steps hidden" id="bonus-task">
            <h2>Bonus: Mit Salt arbeiten</h2>
            <p>Ein Salt ist eine zufällige Zeichenkette, die zu einem Passwort hinzugefügt wird, bevor es gehasht wird. Dies macht Rainbow Tables unwirksam, da jeder Hash einzigartig ist.</p>
            <p>Nutze das folgende Beispiel mit CyberChef:</p>
            <pre>
                Passwort: password123
                Salt: 2023
                Hashing-Methode: MD5
            </pre>
            <p>Finde heraus, was der Hash für dieses Beispiel ist, und gib die Bonus-Flag ein:</p>
            <input type="text" id="flag2" placeholder="Bonus-Flag eingeben">
            <button class="btn" onclick="checkBonusFlag('482c811da5d5b4bc6d497ffa98491e38', '{ADD_A_PINCH_OF_SALT}')">Prüfen</button>
        </div>
    </div>

    <script>
        function checkFlag(password, flag) {
            const input = document.getElementById('flag1').value.trim();
            if (input === password) {
                alert(`Richtig! Hier ist deine Flag: ${flag}`);
                document.getElementById('bonus-task').classList.remove('hidden');
            } else {
                alert("Falsch! Versuche es erneut.");
            }
        }

        function checkBonusFlag(hash, flag) {
            const input = document.getElementById('flag2').value.trim();
            if (input === hash) {
                alert(`Richtig! Hier ist deine Bonus-Flag: ${flag}`);
            } else {
                alert("Falsch! Überprüfe deine Berechnungen.");
            }
        }
    </script>
</body>
</html>

