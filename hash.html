<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hashing und Rainbow Tables Lab</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        h1, h2 {
            text-align: center;
            color: #007bff;
        }
        .info {
            background: #f4f4f4;
            padding: 15px;
            border-left: 4px solid #007bff;
            margin-bottom: 20px;
        }
        .steps {
            margin-top: 20px;
        }
        .steps p {
            margin: 10px 0;
        }
        ol {
            margin: 15px 0;
        }
        .btn {
            display: inline-block;
            padding: 10px 15px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin-top: 10px;
            text-align: center;
        }
        .btn:hover {
            background: #0056b3;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Hashing und Rainbow Tables Lab</h1>

        <div class="info">
            <h2>Was sind Hashes?</h2>
            <p>
                Hashes sind eine wichtige Technologie, um Passwörter und sensible Daten sicher zu speichern. 
                Sie wandeln einen Eingabewert, wie ein Passwort, in eine scheinbar zufällige Zeichenkette um, 
                den sogenannten Hash. Ein wesentlicher Vorteil ist, dass Hashes irreversibel sind – das heißt, 
                man kann den ursprünglichen Wert nicht direkt aus dem Hash berechnen.
            </p>
            <p>
                Dennoch können Angreifer Schwachstellen ausnutzen. Eine Möglichkeit ist die Verwendung von 
                Rainbow Tables. Diese enthalten vorberechnete Hashes für viele mögliche Eingabewerte. 
                Wenn ein Hash in der Rainbow Table enthalten ist, kann der Angreifer den ursprünglichen Wert 
                leicht herausfinden.
            </p>
            <p>
                Um Rainbow Tables unwirksam zu machen, wird oft ein Salt eingesetzt. Dabei handelt es sich 
                um eine zufällige Zeichenkette, die vor dem Hashing an das Passwort angehängt wird. Dadurch 
                wird der Hash einzigartig und in keiner Tabelle zu finden.
            </p>
        </div>

        <div class="steps">
            <h2>Aufgabe</h2>
            <p>Deine Aufgabe ist es, zwei Hashes zu entschlüsseln und die ursprünglichen Passwörter zu finden. Zusätzlich lernst du, wie Salt die Sicherheit erhöht.</p>

            <h3>Schritt 1: Nutze CrackStation</h3>
            <p>
                Öffne <a href="https://crackstation.net/" target="_blank">CrackStation</a>. Füge die folgenden Hashes ein, um zu sehen, welche Passwörter sie repräsentieren:
            </p>
            <pre>
1. 5f4dcc3b5aa765d61d8327deb882cf99
2. 098f6bcd4621d373cade4e832627b4f6
            </pre>
            <p>
                CrackStation durchsucht eine riesige Datenbank und liefert die passenden Passwörter, wenn sie bekannt sind. 
                Überprüfe, welche Ergebnisse du erhältst.
            </p>

            <h3>Schritt 2: Gib die Flag ein</h3>
            <p>Nachdem du die Passwörter gefunden hast, gib eines davon als Flag ein:</p>
            <input type="text" id="flag1" placeholder="Flag eingeben">
            <button class="btn" onclick="checkFlag('password', '{PANZERKNACKER}')">Prüfen</button>
        </div>

        <div class="steps hidden" id="bonus-task">
            <h2>Bonus: Mit Salt arbeiten</h2>
            <p>
                Ein Salt ist eine zufällige Zeichenkette, die vor dem Hashing an das Passwort angehängt wird. Dadurch wird jeder Hash einzigartig – selbst wenn mehrere Personen dasselbe Passwort verwenden. Das schützt vor Rainbow-Table-Angriffen.:
            </p>
            <ol>
                <li>Öffne <a href="https://gchq.github.io/CyberChef/" target="_blank">CyberChef</a>.</li>
                <li>Gib das Passwort <strong>password123</strong> und das Salt <strong>2023</strong> in das Eingabefeld ein.</li>
                <li>Verknüpfe die beiden zu: <strong>password1232023</strong>.</li>
                <li>Suche in CyberChef nach der Operation <strong>MD5</strong> und wende sie an.</li>
            </ol>
            <p>
                Gib den generierten Hash als Flag ein, um die Bonusaufgabe abzuschließen:
            </p>
            <input type="text" id="flag2" placeholder="Bonus-Flag eingeben">
            <button class="btn" onclick="checkBonusFlag()">Prüfen</button>
        </div>
    </div>

    <script>
        function checkFlag(password, flag) {
            const input = document.getElementById('flag1').value.trim();
            if (input === password) {
                alert(`Richtig! Hier ist deine Flag: ${flag}`);
                document.getElementById('bonus-task').classList.remove('hidden');
            } else {
                alert("Falsch! Versuche es erneut.");
            }
        }

        function checkBonusFlag() {
            const input = document.getElementById('flag2').value.trim();
            const correctHash = "482c811da5d5b4bc6d497ffa98491e38"; // Hash von password1232023

            if (input === correctHash) {
                alert("Richtig! Du hast das Hashing mit Salt verstanden. Hier ist deine Bonus-Flag: {ADD_A_PINCH_OF_SALT}");
            } else {
                alert("Falsch! Überprüfe deine Berechnungen und versuche es erneut.");
            }
        }
    </script>
</body>
</html>



