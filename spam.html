<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Spamfilter-Demo · Regeln vs. Lernendes System</title>
  <style>
    /* ====== BASISSTIL ====== */
    :root{
      --bg:#f6f7fb; --panel:#ffffff; --ink:#0b1220; --muted:#4b5563; --accent:#2563eb;
      --ok:#16a34a; --bad:#dc2626; --border:#e5e7eb; --shadow:0 10px 28px rgba(20,30,55,.08);
      --radius:16px; --meta:#6b7280; --divider:#e7e9ee; --sel:#dbeafe;
    }
    *{box-sizing:border-box}
    body{margin:0; font:16px/1.6 Inter, ui-sans-serif, system-ui; color:var(--ink); background:var(--bg)}
    .wrap{max-width:1200px; margin:0 auto; padding:22px}
    h1{font-size:26px; margin:0 0 6px; font-weight:800}
    h2{font-size:20px; margin:0 0 8px}
    .small{font-size:13px; color:var(--muted)}
    .panel{background:var(--panel); border:1px solid var(--border); border-radius:var(--radius); padding:18px; box-shadow:var(--shadow)}
    .divider{height:1px; background:var(--divider); margin:14px 0}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}

    /* ====== POSTEINGANG ====== */
    .inbox-wrap{padding:18px; border:2px solid var(--border); border-radius:20px; background:#fff; box-shadow:var(--shadow)}
    .inbox{display:grid; gap:12px}
    .email-card{
      display:grid; grid-template-columns:56px 1fr auto; gap:14px; align-items:center;
      background:#fff; border:1px solid var(--border); border-radius:14px; padding:14px;
      transition:background .12s, transform .12s;
    }
    .email-card:hover{transform:translateY(-1px)}
    .email-card.selected{background:var(--sel); border-color:#93c5fd}
    .avatar{width:44px; height:44px; border-radius:999px; background:#e5e7eb; display:grid; place-items:center; font-weight:800; color:#1e3a8a}
    .subject{font-weight:900; font-size:17px}
    .snippet{color:var(--muted); font-size:14px; margin-top:2px}
    .meta{color:var(--meta); font-size:12px; margin-top:2px}
    .label{padding:4px 10px; border-radius:999px; font-size:12px; font-weight:700}
    .ok{background:#dcfce7; color:#166534}
    .bad{background:#fee2e2; color:#991b1b}

    /* ====== INTERAKTION ====== */
    label input[type="checkbox"]{transform:translateY(1px)}
    input[type=range]{width:140px}
    button{cursor:pointer; border:1px solid var(--border); border-radius:8px; background:var(--accent); color:#fff; font-weight:600; padding:6px 14px}
    button:hover{opacity:.9}
    table{width:100%; border-collapse:collapse; background:#fff; border:1px solid var(--border); border-radius:10px; overflow:hidden}
    th,td{padding:10px; border-bottom:1px solid var(--border); text-align:left}
    thead th{background:#f3f4f6; color:#374151; font-weight:700; font-size:13px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Spamfilter-Demo: Regelbasiert vs. Lernendes System</h1>
    <p class="small">Didaktische Simulation mit kommentiertem Code und realistischen Beispielen.</p>

    <!-- ===================== POSTEINGANG ===================== -->
    <section class="inbox-wrap">
      <h2>Posteingang</h2>
      <div id="inbox" class="inbox"></div>
    </section>

    <!-- ===================== REGELBASIERTES SYSTEM ===================== -->
    <section class="panel">
      <h2>Regelbasiertes System</h2>
      <p class="small">Wenn eine aktivierte Regel zutrifft → Spam. Jede Regel kann einzeln deaktiviert werden.</p>
      <div class="row">
        <label><input type="checkbox" class="rule" data-key="g" checked> „gratis“ im Betreff</label>
        <label><input type="checkbox" class="rule" data-key="k" checked> Verdächtige Domäne</label>
        <label><input type="checkbox" class="rule" data-key="l" checked> Alles GROSS</label>
        <label><input type="checkbox" class="rule" data-key="c" checked> Dringlichkeit</label>
        <label><input type="checkbox" class="rule" data-key="d" checked> Werbung</label>
      </div>
      <div class="divider"></div>
      <p><strong>Aktuelle Entscheidung:</strong> <span id="ruleOut">–</span></p>
      <p class="small mono" id="ruleWhy"></p>
    </section>

    <!-- ===================== LERNENDES SYSTEM ===================== -->
    <section class="panel">
      <h2>Lernendes System (Perzeptron)</h2>
      <p class="small">Gewichte können angepasst werden – das System lernt, welche Merkmale wichtiger sind.</p>
      <div class="row">
        <label>w₁<input type="range" id="w0" min="-2" max="2" step="0.1" value="0.9"></label>
        <label>w₂<input type="range" id="w1" min="-2" max="2" step="0.1" value="0.3"></label>
        <label>w₃<input type="range" id="w2" min="-2" max="2" step="0.1" value="0.6"></label>
        <label>w₄<input type="range" id="w3" min="-2" max="2" step="0.1" value="0.5"></label>
        <label>w₅<input type="range" id="w4" min="-2" max="2" step="0.1" value="0.7"></label>
        <label>θ<input type="range" id="theta" min="0" max="3" step="0.1" value="1.2"></label>
      </div>
      <div class="divider"></div>
      <p><strong>Aktuelle Entscheidung:</strong> <span id="neuOut">–</span></p>
      <p class="small mono" id="neuSum"></p>
    </section>

    <!-- ===================== VERGLEICH ===================== -->
    <section class="panel">
      <h2>Vergleich aller Mails</h2>
      <table>
        <thead><tr><th>Mail</th><th>Regel-System</th><th>Perzeptron</th><th>Soll</th></tr></thead>
        <tbody id="compare"></tbody>
      </table>
    </section>
  </div>

  <script>
  /* ===================== JAVASCRIPT: LOGIK ===================== */

  document.addEventListener("DOMContentLoaded", () => {

    // --------- DATEN: Beispiele mit unterschiedlichen Merkmalen ---------
    // g=gratis, k=typo, l=ALL CAPS, c=Dringlichkeit, d=Werbung, y=Soll (1=Spam)
    const mails = [
      { subj:"GRATIS IPHONE JETZT SICHERN", from:"rnicrosoft@support-mail.com", g:1,k:1,l:1,c:1,d:1,y:1, snip:"Nur heute – Ihr exklusives Geschenk wartet!" },
      { subj:"Ihr Paket konnte nicht zugestellt werden", from:"service@am4zon-help.net", g:0,k:1,l:0,c:1,d:0,y:1, snip:"Bitte Adresse bestätigen, um erneute Lieferung zu starten." },
      { subj:"SONDERAKTION NUR HEUTE", from:"deals@shopping-world.net", g:0,k:0,l:1,c:1,d:1,y:1, snip:"Profitieren Sie jetzt von unserem exklusiven Sale." },
      { subj:"Dringend: Passwort läuft ab", from:"support@schule.de", g:0,k:0,l:0,c:1,d:0,y:0, snip:"Interne Erinnerung: Passwort alle 90 Tage ändern." }, // sieht spammy aus, ist aber echt
      { subj:"Elternabend – Raumänderung", from:"sekretariat@schule.de", g:0,k:0,l:0,c:0,d:0,y:0, snip:"Der Termin bleibt, aber neuer Raum B104." },
      { subj:"Gewinn bestätigt: Jetzt PRÄMIE abholen", from:"gewinn@lotto-online.net", g:1,k:0,l:1,c:1,d:1,y:1, snip:"Ihre Prämie wartet auf Sie." },
      { subj:"Newsletter Oktober", from:"newsletter@stadtbibliothek.de", g:0,k:0,l:0,c:0,d:1,y:0, snip:"Neue Medien, Veranstaltungen und Tipps." }, // Werbung, aber kein Spam
      { subj:"RECHNUNG Oktober", from:"buchhaltung@service.de", g:0,k:0,l:1,c:0,d:0,y:0, snip:"Im Anhang finden Sie Ihre Monatsabrechnung." }, // nur 1 Merkmal (Caps)
      { subj:"Eilmeldung: Konto gesperrt", from:"secure@bank-alerts.net", g:0,k:1,l:0,c:1,d:0,y:1, snip:"Bitte sofort einloggen und verifizieren." } // typischer Scam
    ];

    const inbox = document.getElementById("inbox");
    const compare = document.getElementById("compare");
    const ruleOut = document.getElementById("ruleOut");
    const ruleWhy = document.getElementById("ruleWhy");
    const neuOut = document.getElementById("neuOut");
    const neuSum = document.getElementById("neuSum");
    const ruleBoxes = Array.from(document.querySelectorAll(".rule"));
    const sliders = ["w0","w1","w2","w3","w4"].map(id=>document.getElementById(id));
    const theta = document.getElementById("theta");

    let selected = 0;

    // --------- Hilfsfunktionen ---------
    const features = m => [m.g,m.k,m.l,m.c,m.d];
    const weights = () => sliders.map(s=>parseFloat(s.value));
    const Θ = () => parseFloat(theta.value);

    // Regelentscheidung
    function ruleDecision(m){
      const active = ruleBoxes.filter(ch=>ch.checked && m[ch.dataset.key]===1);
      return {y:active.length>0?1:0, why:active.map(a=>a.nextSibling.textContent.trim()).join(", ")||"keine aktiv"};
    }

    // Lernende Entscheidung
    function neuronDecision(m){
      const x = features(m);
      const w = weights();
      const sum = x.reduce((s,xi,i)=>s+xi*w[i],0);
      const y = sum>=Θ()?1:0;
      return {y,sum};
    }

    // Auswertungen aktualisieren
    function update(){
      const m = mails[selected];
      inbox.querySelectorAll(".email-card").forEach((e,i)=>e.classList.toggle("selected",i===selected));

      const rule = ruleDecision(m);
      ruleOut.textContent = rule.y?"Spam":"Kein Spam";
      ruleOut.className = rule.y?"bad":"ok";
      ruleWhy.textContent = "Aktiv: " + rule.why;

      const neu = neuronDecision(m);
      neuOut.textContent = neu.y?"Spam":"Kein Spam";
      neuOut.className = neu.y?"bad":"ok";
      neuSum.textContent = `Summe = ${neu.sum.toFixed(2)} / θ = ${Θ().toFixed(2)}`;

      compare.innerHTML = mails.map(mm=>{
        const r=ruleDecision(mm).y;
        const n=neuronDecision(mm).y;
        return `<tr><td>${mm.subj}</td>
          <td class="${r?'bad':'ok'}">${r?'Spam':'Kein Spam'}</td>
          <td class="${n?'bad':'ok'}">${n?'Spam':'Kein Spam'}</td>
          <td class="${mm.y?'bad':'ok'}">${mm.y?'Spam':'Kein Spam'}</td></tr>`;
      }).join("");
    }

    // --------- Rendering des Posteingangs ---------
    inbox.innerHTML = mails.map((m,i)=>`
      <div class="email-card ${i===0?'selected':''}" data-i="${i}">
        <div class="avatar">${m.subj[0]}</div>
        <div>
          <div class="subject">${m.subj}</div>
          <div class="snippet">${m.snip}</div>
          <div class="meta">Von: ${m.from}</div>
        </div>
        <div class="label ${m.y?'bad':'ok'}">${m.y?'Soll: Spam':'Soll: Kein Spam'}</div>
      </div>
    `).join("");

    inbox.addEventListener("click", e=>{
      const card = e.target.closest(".email-card");
      if(!card) return;
      selected = parseInt(card.dataset.i);
      update();
    });

    document.addEventListener("input", e=>{
      if(e.target.matches(".rule,input[type=range]")) update();
    });

    // Initial anzeigen
    update();
  });
  </script>
</body>
</html>








